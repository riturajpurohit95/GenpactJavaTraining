package com.ShopSphere.shop_sphere.service;

import java.util.List;
import java.util.stream.Collectors;

import org.springframework.stereotype.Service;

import com.ShopSphere.shop_sphere.dto.CartItemDto;
import com.ShopSphere.shop_sphere.model.CartItem;
import com.ShopSphere.shop_sphere.repository.CartItemDao;

@Service
public class CartItemServiceImpl implements CartItemService{
	
	private final CartItemDao cartItemDao;
	
	public CartItemServiceImpl(CartItemDao cartItemDao) {
		this.cartItemDao = cartItemDao;
	}

	@Override
	public CartItemDto addItem(CartItemDto cartItemDto) {
		CartItem item = new CartItem();
		item.setCartId(cartItemDto.getCartId());
		item.setProductId(cartItemDto.getProductId());
		item.setQuantity(cartItemDto.getQuantity());
		
		CartItem savedItem = cartItemDao.addItem(item);
		CartItemDto response = new CartItemDto();
		
		response.setCartItemId(savedItem.getCartItemsId());
		response.setCartId(savedItem.getCartId());
		response.setProductId(savedItem.getProductId());
		response.setQuantity(savedItem.getQuantity());
		
		return response;
		
	}

	@Override
	public List<CartItemDto> getItemByCartId(int cartId) {
		return cartItemDao.findAllByCartId(cartId)
							.stream()
							.map(item -> new CartItemDto(
							item.getCartItemsId(),
							item.getCartId(),
							item.getProductId(),
							item.getQuantity()
							)).collect(Collectors.toList());
	}

	@Override
	public CartItemDto updateItemQuantity(int cartItemId, int quantity) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public void deleteItem(int cartItemId) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public boolean existsInCart(int cartId, int productId) {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public void deleteItemByProductId(int cartId, int productId) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public double calculateTotalAmount(int cartId) {
		// TODO Auto-generated method stub
		return 0;
	}
	
	

}
